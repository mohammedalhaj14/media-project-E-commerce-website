# Use an official PHP image with the Apache web server (Matching your XAMPP setup)
FROM php:8.2-apache

# 1. Install required PHP extensions (Crucial for SQLite)
# This installs the PHP Data Objects (PDO) and the SQLite driver.
RUN docker-php-ext-install pdo pdo_sqlite

# 2. Enable Apache Rewrite Module
RUN a2enmod rewrite

# 3. Set the working directory to the web root
WORKDIR /var/www/html

# 4. Copy project files from your Git repository into the container
COPY . .

# 5. Create the database directory and file, and ensure web server user (www-data) 
#    has correct read/write permissions.
#    The path 'Database/database.sqlite' matches your project structure.
RUN mkdir -p Database \ 
    && touch Database/database.sqlite \
    && chown -R www-data:www-data Database

# 6. Expose the default HTTP port
EXPOSE 80

# 7. Start the Apache web server in the foreground
CMD ["apache2-foreground"]